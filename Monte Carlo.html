<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<meta name="description" content="">
        <meta name="keywords" content="">
		<title>Zehao Song</title>
		<!-- Favicon -->
        <link href="assets/images/favicon.png" rel="shortcut icon">
		<!-- CSS -->
		<link href="assets/plugins/bootstrap/bootstrap.min.css" rel="stylesheet">
		<link href="assets/plugins/owl-carousel/owl.carousel.min.css" rel="stylesheet">
		<link href="assets/plugins/owl-carousel/owl.theme.default.min.css" rel="stylesheet">
		<link href="assets/plugins/magnific-popup/magnific-popup.min.css" rel="stylesheet">
		<link href="assets/plugins/sal/sal.min.css" rel="stylesheet">
		<link href="assets/css/theme.css" rel="stylesheet">
		<!-- Fonts/Icons -->
		<link href="assets/plugins/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
		<link href="assets/plugins/font-awesome/css/all.css" rel="stylesheet">
	</head>
	<style>
	.imgcenter {
	  display: block;
	  margin-left: auto;
	  margin-right: auto;
	  width: 50%;
	}
	</style>
	<body data-preloader="1">

		<!-- Header -->
		<div class="header right dark sticky-autohide">
			<div class="container">
				<!-- Logo -->
				<div class="header-logo">
					<h3><a href="index.html">Daniel Song</a></h3>
				</div>
				<!-- Menu -->
				<div class="header-menu">
					<ul class="nav">
						<li class="nav-item">
							<a class="nav-link" href="about-me.html">About me</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="#">Personal life</a>
							<ul class="nav-dropdown">
								<li class="nav-dropdown-item"><a class="nav-dropdown-link" href="golf.html">Golf</a></li>
								<li class="nav-dropdown-item"><a class="nav-dropdown-link" href="webdesign.html">Webdesign</a></li>
								<li class="nav-dropdown-item"><a class="nav-dropdown-link" href="work.html">Work</a></li>
								<li class="nav-dropdown-item"><a class="nav-dropdown-link" href="travel.html">Travel</a></li>
							</ul>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="#">My Studies</a>
							<ul class="nav-dropdown">
								<li class="nav-dropdown-item">
									<a class="nav-dropdown-link" href="#">Astrophysics</a>
									<ul class="nav-subdropdown">
										<li class="nav-subdropdown-item"><a class="nav-subdropdown-link" href="Stellar Age.html">Stellar Age of the Beehive Cluster</a></li>
									</ul>
								</li>
								<li class="nav-dropdown-item">
									<a class="nav-dropdown-link" href="#">Computational Physics</a>
									<ul class="nav-subdropdown">
										<li class="nav-subdropdown-item"><a class="nav-subdropdown-link" href="Monte Carlo.html">Monte Carlo simulation of Brownian motion</a></li>
										<li class="nav-subdropdown-item"><a class="nav-subdropdown-link" href="Covid-19.html">Covid-19 time series analysis</a></li>
										<li class="nav-subdropdown-item"><a class="nav-subdropdown-link" href="Three body.html">Three body system problem</a></li>
									</ul>
								</li>
								<li class="nav-dropdown-item">
									<a class="nav-dropdown-link" href="#">Quantum Mechanic</a>
									<ul class="nav-subdropdown">
										<li class="nav-subdropdown-item"><a class="nav-subdropdown-link" href="Fabry Perot.html">Fabry–Pérot interferometer</a></li>
									</ul>
								</li>
								<li class="nav-dropdown-item">
									<a class="nav-dropdown-link" href="#">Classical Mechanic</a>
									<ul class="nav-subdropdown">
										<li class="nav-subdropdown-item"><a class="nav-subdropdown-link" href="Physical Pendulum.html">Physical Pendulum</a></li>
										<li class="nav-subdropdown-item"><a class="nav-subdropdown-link" href="Mechanical Resonance.html">Mechanical Resonance</a></li>
									</ul>
								</li>
							</ul>
						</li>
					</ul>
				</div>
				<!-- Menu Extra -->
				<div class="header-menu-extra">
					<ul class="list-inline">
						<li><a href="https://www.facebook.com/daniel.song.31/"><i class="bi bi-facebook"></i></a></li>
						<li><a href="https://www.linkedin.com/in/daniel-song-945008178/"><i class="bi bi-linkedin"></i></a></li>
						<li><a href="https://www.instagram.com/daniellsong/"><i class="bi bi-instagram"></i></a></li>
					</ul>
				</div>
				<!-- Menu Toggle -->
				<button class="header-toggle">
					<span></span>
				</button>
			</div><!-- end container -->
		</div>
		<!-- end Header -->
		
		<!-- Hero section -->
		<div class="section-lg bg-dark">
			<div class="container text-center">
				<h1>Monte Carlo simulation of random walk and Brownian motion</h1>
				<ul class="list-inline">
					<li><a href="https://www.sfu.ca/physics.html"><i class="fas fa-user-tie margin-right-10"></i><span>Department of Physics, Simon Fraser University</span></a></li>
					<li><i class="fas fa-map-marker-alt margin-right-10"></i><span>Burnaby, British Columbia Canada V5A 1S6</span></li>
				</ul>
			</div><!-- end container -->
		</div>
		<!-- end Hero section -->

		<!-- Job Listing Details -->
		<div class="section">
			<div class="container">
				<div class="row g-5">
					<div class="col-12 col-lg-12">
						<div>
							<h5 class="fw-medium">Abstract</h5>
							<p>In biophysics, we studied random walks and diffusion. We can calculate the probability of getting a
								particle at position n by the binomial distribution. These topics remind me, how to calculate probability of random work numerically? 1D? 2D? or even 3D? And what are applications of
								it? After some research, I find out a popular method called Monte Carlo method[<a href="#ct1" style="color:red;"><b>1</b></a>] which has
								been used in many areas such as biology, statistic, and engineering. In this report, I will discuss the
								overall study plan for this method and perform python simulation for the random walk. Then, I will
								investigate applications of Monte Carlo random walk simulation.</p>
						</div>
						<div>
							<h5 class="margin-top-30 margin-lg-top-40">Introduction</h5>
							<p>A random walk is a random process that shows how a particle can move in some space. In
								biophysics, many stochastic data can be involved in a single system. How should we analyze
								a large amount of information computationally? This report will introduce the Monte Carlo
								method, a stochastic model that is useful to study random walks.
								The Monte Carlo method is a powerful numerical random sampling method that uses
								randomness to solve problems with many degrees of freedom in a system. To understand the
								science behind it, this method requires some understanding of the random walk model and
								study of Monte Carlo simulation to implement it numerically, then study particle Brownian
								motion, extend the Monte Carlo algorithm class to simulate the process. After all the studies,
								I will be able to use the Monte Carlo technique to visualize the random walk process and
								use the extended algorithm to simulate the complex problem.
								We know that a 1-D random walk follows the binomial distribution</p>
							<p>
							\[P(n_{i};n) = { Wp^nq^{n-n_{i}} }.\]
							</p>
							<p>where W is the combination of $$nCn_{i} = \frac{n!}{n_{i}!\left(n-n_{i}\right)!}$$</p>
							<p>
							p is the probability of moving right, and q is the probability of driving left. If it is a fair walk, 
							the probability of each steps are equal. The probability distribution should follow the normal distribution if it is a fair walk. 
							In this way, assume there is a particle that can only move left or right randomly at each step. Without binomial distribution, 
							how should we find the probability of the particle at a position after several steps? The Monte Carlo method provides an idea about extensive sampling. 
							We know the chance of moving left or right is 0.5, we can set up a large number random steps walk simulation, which simulates multiple times of random particle walk,
							we record the final position each time. The probability of particle at x is the number of trails at x divides the total number of trails. Even though we don't 
							know the distribution, this method can still find the approximate probability. Why should we consider the situation without distribution? Many particles under quantum 
							mechanic situation won't show proper distribution with wave-particle duality, such as Boson sampling, particles can be in different quantum states. Normally, we know the 
							probability distribution first, so we can calculate the chance, the Monte Carlo method reverses the process, we know the probability from big samples, then we can predict 
							the distribution.
							</p>
						</div>
						<div>
							<h5 class="margin-top-30 margin-lg-top-40">Methods and results</h5>
							<p>First, by setting up a 1-D fair random walk process, run the process for N=1000 times with a step size of 1000. 
							Then plot the data in a histogram. See Fig. <a href="#fg1" style="color:blue;"><b>1</b></a>. We can see that the bell shape pattern follows the discrete binomial distribution. 
							The mean is approaching zero, and the variance is around N. When N gets large, we can find the pattern follows the binomial distribution. 
							With central limit theorem, the data will follow normal distribution. The result has a mean value of -0.344 and standard deviation of 33.25. These numbers will change everytime
							(of course it is a random process).</p>
							<img src="assets/images/1DRW.png" class = "imgcenter" id = "fg1">
							<p>Second, with the idea of a 1-D random walk, I extend the simulation to 2-D, which
							implement by setting a function with 0.25 chance to go up, down, left, or right in 2-D space.
							We can see from Fig. <a href="#fg2" style="color:blue;"><b>2</b></a>, all data points diffuse from the center, the density in the middle is
							the highest, which shows both x and y displacement have mean values of zero. 
							<img src="assets/images/2DRW.png" class = "imgcenter" id = "fg2">
							In this case,
							both x and y displacements follow binomial distribution. In general, the mean and variance
							of a step size random walk(every step is a units), with probability q of moving left will be[<a href="#ct2" style="color:red;"><b>2</b></a>]</p>
							<p>
							$$&lt;x&gt;= \sum_{i=1}^{N}&lt;x_{i}&gt; = N\left(aq-a(1-q)\right) = aN\left(2q-1\right)$$
							</p>
							<p>
							$$\sigma ^2 = &lt;x^2&gt; - &lt;x&gt;^2 = N\left(a^2q+a^2\left(1-q\right)-&lt;x&gt;^2\right) = 4a^2Nq\left(1-q\right)$$
							</p>
							<p>
							with central limit theorem, when N gets large, the data will approach Gaussian distribution(in all dimensions).
							</p>
						</div>
						<div>
							<h5 class="margin-top-30 margin-lg-top-40">Brownian motion and Metropolis-Hastings algorithm</h5>
							<p>Now we understand the basic concept of stochastic simulation. It is time to do use it for
							a real-world problem, such as Brownian motion, discovered by Robert Brown in 1827, who studied pollen movement in the water. 
							Brownian motion is the random motion of particle
							in a medium. For example, in water, the particle may get hit by the water molecules in
							all directions and move randomly (<a href="https://en.wikipedia.org/wiki/Brownian_motion#/media/File:Brownian_motion_large.gif"><b>Animated example</b></a>[<a href="#ct3" style="color:red;"><b>3</b></a>]). The probability of the Brownian
							motion step depends only on the current particle state and is not affected by the past. This
							process is defined as Markov Chain[<a href="#ct4" style="color:red;"><b>4</b></a>].
							</p>
							<p>A famous algorithm in random sampling is called the Metropolis-Hastings algorithm. It
								is one of the Markov Chain Monte Carlo method for obtaining a sequence of random samples
								from a probability model when direct sampling is difficult. The algorithm has the follow
								steps: First, we pick a initial state, such as my choice (x = 0, y = 0) in Brownian motion.
								Next, we know that random walk will approach normal distribution as sample size increases,
								so we can choice two random numbers (α, β) from normal distribution and add it to the
								initial state (x′ = x + α, y′ = y + β). Then we calculate the acceptance ratio, which is
								the probability to accept the proposed state x′ and y′. The common choice for it is the
								Metropolis choice[<a href="#ct5" style="color:red;"><b>5</b></a>]
							</p>
							<p>
							$$A(x',x_{t}) = min(1,\frac{P(x')}{P(x_{t})}\frac{norm(x_{t}|x')}{norm(x'|x_{t})})$$
							</p>
							<p>
							where A is the acceptance ratio between x′ and xt state, P is the distribution model(2-D
							random walk model) and norm is normal distribution. We chose the minimal value between
							1 and the ratio. After that, we pick a random number c between 0 and 1 from uniform
							distribution and compare it with our acceptance ratio. If A ≥ c, we accept the move.
							Otherwise, we reject the move[<a href="#ct6" style="color:red;"><b>6</b></a>]. It is hard to show all details and proof in this report.
							More details at <a href="http://www.probability.ca/hastings/hastings.pdf"><b>information</b></a>[<a href="#ct4" style="color:red;"><b>4</b></a>].
							</p>
							<p>
							For 2-D Brownian motion, the model we use will be similar to a 2-D random walk. We
							only need to know the probability distribution so that we will set up the function with only
							one step, each step the particle has a 0.25 chance to go up, down, left, or right, the final
							output is a 2-D array which store the final position (x, y). Then, set the initial state at
							(0, 0) and 5000 Metropolis steps, for each step the algorithm checks the acceptance of x and
							y, if the step is accepted, the particle will move to the new position. This situation is all
							randomized, the current position is independent from other steps, which is what happening
							when a particle is in a medium. See Fig. 3. This simulation is very useful in biology.
							Many protein-based molecular motors may also be Brownian motors. Brownian motors are
							molecular machines that use chemical reactions to move in space, such as ATP synthase and myosin II[<a href="#ct7" style="color:red;"><b>7</b></a>]. 
							Moreover, many nanotechnologies require Brownian motion as the primary
							control factor, for example, a nanobot. Imaging a nanobot that can check over the whole
							body of a human, it needs energy to move, but in nano-size, it is hard to design energy
							storage in the robot, so the nanobot is designed to take bias Brownian motion(design the
							nanobot to take step/move unequally) to get in the correct direction[<a href="#ct8" style="color:red;"><b>8</b></a>].
							</p>
						</div>
						
						<div class="margin-top-30 margin-lg-top-40">
							<h5 class="fw-medium">References</h5>
							<ul class="list-dash">
								<li id="ct1">[1] Subhadip R. (2013). <i>Kinetic Monte Carlo Simulation in Biophysics and Systems Biology</i>. In-
									techOpen.</li>
								<li id="ct2">[2] Andrej K. (2018). <i>MAE 545: Lecture 17 Random walks</i>. Princeton University, Mechanical and Aerospace Engineering.</li>
								<li id="ct3">[3] Paco, Hwang. (2016). <i>Ejs Open Source Brownian Motion Gas Model Java Applet</i>. Open Source Physics@Singapore.</li>
								<li id="ct4">[4] Hastings WK. (1970) <i>Monte Carlo sampling methods using Markov chains and their applications</i>. Biometrika. University of Toronto. Page 98.</li>
								<li id="ct5">[5] Eichler M. (2004) <i>S12: Metropolis-Hastings Algorithm</i>. University of Chicago, Department of Statistic. Page 1-4.</li>
								<li id="ct6">[6] Linnankoski M. (2020). <i>Estimating the dynamics of a geometric Brownian motion using MCMC</i>. Aalto University, School of Science.</li>
								<li id="ct7">[7] Wikipedia contributors. (2022). Brownian motor. Wikipedia.</li>
								<li id="ct8">[8] Kelty C, Hutchinson J. (2009) <i>Nanotechnology: Content and Context</i>. Openstax. Section 2.2: Brownian Motion.</li>
							</ul>
						</div>
					</div>
				</div><!-- end row -->
			</div><!-- end container -->
		</div>
		<!-- Job Listing Details -->

		<footer>
			<div class="section bg-dark">
				<div class="container">
					<div class="row g-4 align-items-center">
						<div class="col-12 col-md-6 text-center text-md-start">
							<ul class="list-inline-dash">
								<li><a href="#">FAQ</a></li>
								<li><a href="#">Careers</a></li>
							</ul>
							<p class="margin-top-10">&copy;Zehao Song, All Rights Reserved.</p>
						</div>
						<div class="col-12 col-md-6 text-center text-md-end">
							<ul class="list-inline">
								<li><a href="https://www.facebook.com/daniel.song.31/"><i class="bi bi-facebook"></i></a></li>
								<li><a href="https://www.linkedin.com/in/daniel-song-945008178/"><i class="bi bi-linkedin"></i></a></li>
								<li><a href="https://www.instagram.com/daniellsong/"><i class="bi bi-instagram"></i></a></li>
							</ul>
						</div>
					</div><!-- end row -->
				</div><!-- end container -->
			</div>
		</footer>

		<!-- Scroll to top button -->
		<div class="scrolltotop">
			<a class="button-circle button-circle-sm button-circle-dark" href="#"><i class="bi bi-arrow-up"></i></a>
		</div>
		<!-- end Scroll to top button -->

		<!-- ***** JAVASCRIPTS ***** -->
		<script src="assets/plugins/jquery.min.js"></script>
		<script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY"></script>
		<script src="https://polyfill.io/v3/polyfill.min.js?features=IntersectionObserver"></script>
		<script src="assets/plugins/plugins.js"></script>
		<script src="assets/js/functions.js"></script>
		<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
		<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>
	</body>
</html>