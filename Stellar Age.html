<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<meta name="description" content="">
        <meta name="keywords" content="">
		<title>Zehao Song</title>
		<!-- Favicon -->
        <link href="assets/images/favicon.png" rel="shortcut icon">
		<!-- CSS -->
		<link href="assets/plugins/bootstrap/bootstrap.min.css" rel="stylesheet">
		<link href="assets/plugins/owl-carousel/owl.carousel.min.css" rel="stylesheet">
		<link href="assets/plugins/owl-carousel/owl.theme.default.min.css" rel="stylesheet">
		<link href="assets/plugins/magnific-popup/magnific-popup.min.css" rel="stylesheet">
		<link href="assets/plugins/sal/sal.min.css" rel="stylesheet">
		<link href="assets/css/theme.css" rel="stylesheet">
		<!-- Fonts/Icons -->
		<link href="assets/plugins/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
		<link href="assets/plugins/font-awesome/css/all.css" rel="stylesheet">
	</head>
	<style>
	.imgcenter {
	  display: block;
	  margin-left: auto;
	  margin-right: auto;
	  width: 50%;
	}
	</style>
	<body data-preloader="1">

		<!-- Header -->
		<div class="header right dark sticky-autohide">
			<div class="container">
				<!-- Logo -->
				<div class="header-logo">
					<h3><a href="index.html">Daniel Song</a></h3>
				</div>
				<!-- Menu -->
				<div class="header-menu">
					<ul class="nav">
						<li class="nav-item">
							<a class="nav-link" href="about-me.html">About me</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="#">Personal life</a>
							<ul class="nav-dropdown">
								<li class="nav-dropdown-item"><a class="nav-dropdown-link" href="golf.html">Golf</a></li>
								<li class="nav-dropdown-item"><a class="nav-dropdown-link" href="webdesign.html">Webdesign</a></li>
								<li class="nav-dropdown-item"><a class="nav-dropdown-link" href="work.html">Work</a></li>
								<li class="nav-dropdown-item"><a class="nav-dropdown-link" href="travel.html">Travel</a></li>
							</ul>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="#">My Studies</a>
							<ul class="nav-dropdown">
								<li class="nav-dropdown-item">
									<a class="nav-dropdown-link" href="#">Astrophysics</a>
									<ul class="nav-subdropdown">
										<li class="nav-subdropdown-item"><a class="nav-subdropdown-link" href="Stellar Age.html">Stellar Age of the Beehive Cluster</a></li>
									</ul>
								</li>
								<li class="nav-dropdown-item">
									<a class="nav-dropdown-link" href="#">Computational Physics</a>
									<ul class="nav-subdropdown">
										<li class="nav-subdropdown-item"><a class="nav-subdropdown-link" href="Monte Carlo.html">Monte Carlo simulation of Brownian motion</a></li>
										<li class="nav-subdropdown-item"><a class="nav-subdropdown-link" href="Covid-19.html">Covid-19 time series analysis</a></li>
										<li class="nav-subdropdown-item"><a class="nav-subdropdown-link" href="Three body.html">Three body system problem</a></li>
									</ul>
								</li>
								<li class="nav-dropdown-item">
									<a class="nav-dropdown-link" href="#">Quantum Mechanic</a>
									<ul class="nav-subdropdown">
										<li class="nav-subdropdown-item"><a class="nav-subdropdown-link" href="Fabry Perot.html">Fabry–Pérot interferometer</a></li>
									</ul>
								</li>
								<li class="nav-dropdown-item">
									<a class="nav-dropdown-link" href="#">Classical Mechanic</a>
									<ul class="nav-subdropdown">
										<li class="nav-subdropdown-item"><a class="nav-subdropdown-link" href="Physical Pendulum.html">Physical Pendulum</a></li>
										<li class="nav-subdropdown-item"><a class="nav-subdropdown-link" href="Mechanical Resonance.html">Mechanical Resonance</a></li>
									</ul>
								</li>
							</ul>
						</li>
					</ul>
				</div>
				<!-- Menu Extra -->
				<div class="header-menu-extra">
					<ul class="list-inline">
						<li><a href="https://www.facebook.com/daniel.song.31/"><i class="bi bi-facebook"></i></a></li>
						<li><a href="https://www.linkedin.com/in/daniel-song-945008178/"><i class="bi bi-linkedin"></i></a></li>
						<li><a href="https://www.instagram.com/daniellsong/"><i class="bi bi-instagram"></i></a></li>
					</ul>
				</div>
				<!-- Menu Toggle -->
				<button class="header-toggle">
					<span></span>
				</button>
			</div><!-- end container -->
		</div>
		<!-- end Header -->
		
		<!-- Hero section -->
		<div class="section-lg bg-dark">
			<div class="container text-center">
				<h1>Stellar Age of Beehive Cluster</h1>
				<ul class="list-inline">
					<li><a href="https://www.sfu.ca/physics.html"><i class="fas fa-user-tie margin-right-10"></i><span>Department of Physics, Simon Fraser University</span></a></li>
					<li><i class="fas fa-map-marker-alt margin-right-10"></i><span>Burnaby, British Columbia Canada V5A 1S6</span></li>
				</ul>
			</div><!-- end container -->
		</div>
		<!-- end Hero section -->

		<!-- Job Listing Details -->
		<div class="section">
			<div class="container">
				<div class="row g-5">
					<div class="col-12 col-lg-12">
						<div>
							<h5 class="fw-medium">Abstract</h5>
							<p>The Beehive Star cluster(M44, Praesepe) is one of the nearest open cluster in Cancer constel-
								lation. This report contains details about the fitting isochrone method to estimate the stellar age
								by using the image data from March 15, 2021. Taking in SFU Trottier Observatory over 3 hours. This project
								is based on anaconda environment python and contents a lot of special function. There are many different algorithms to analysis the data and image, but I can't provide all the details or this article will be very very long... which no one wants to read a 3 hours article about the logic behind code right:)? If the word is <b>bold</b>, then it is a algorithms or method.
								If you want to learn more
								about the detail, feel free to contact me.</p>
						</div>
						<div>
							<h5 class="margin-top-30 margin-lg-top-40">Introduction</h5>
							<p>In 1609, Galileo first observed the Beehive and resolved it into 40 stars. This is the
								Beehive Cluster, also known as Praesepe, M44, is an open cluster near Earth, with an
								apparent magnitude of 3.7 and a distance of 520 to 610 light years from the Earth [<a href="#ct1" style="color:red;"><b>1</b></a>].
								M44 is highly observable during February to May, by the time Cancer rises high in the
								sky for northern observers like in Vancouver [<a href="#ct2" style="color:red;"><b>2</b></a>]. It can be easily observe by a CCD. This
								project focuses on the estimation of cluster age of M44 by using an isochrone, and compare
								the H-R diagram with isochrone.</p>
							<p>
						</div>
						<div>
							<h5 class="margin-top-30 margin-lg-top-40">Theory</h5>
							<p id = "eq1">By using equation</p>
							<p>
							$$S_{\textrm{C}} = \frac{S_{\textrm{R}} - t{D} - B}{F}$$
							</p>
							<p>where Sc stands for calibrated science frame, Sr is the raw data frame, 
							t is the exposure time, D is the master dark current, B 
							is the master bias and F is the master flat. I can get the calibrated image from raw data image.  
							</p>
							<p>
							With calibrated image, in order to make the a H-R diagram, I need to shift the calibrated images to a common pixel frame using <b>reproject_interp</b> command with World Coordinate System(WCS). This step will align all the exposures onto same pixels. 
							Then combine pixels into a single image by using <b>sigma_clip</b> method.
							</p>
							In order to show sources only, sky subtraction from python <b>sep</b> will be very useful. By
							using <b>Background</b> algorithm to do background estimation, I can get a sources only image
							which the sources can be detected by using <b>extract</b> algorithm.
							<br>
							The above theoretical steps are about making clear images for photometry. Photometry
							is measuring the light magnitudes of stars so I can compare it with colours. A H-R diagram
							is needed for estimating the cluster age.
							<br/>
							Isochrone is a curve which represents stars of same age. Newborn stars of low mass are
cold but luminous. With time pass, these stars decrease luminosity and stay around the same
temperature until they reach the main sequence of the isochrone. Comparing H-R diagram
with selected isochrone, I can get an estimate value for age by fitting a mpfit(see more at <a href="https://en.wikipedia.org/wiki/Levenberg%E2%80%93Marquardt_algorithm" style="color:black;"><b>Levenberg-
Marquardt least-squares fit</b></a>).
						</div>
						<div>
							<h5 class="margin-top-30 margin-lg-top-40">Methods</h5>
							<p>On March, 15, 2021 at 9pm. By using CCD camera at SFU Trottier Observatory with
exposure time = 5 sec for single exposures and bin = 1, our group collected a total of
35 images, 12 exposures, each exposures have three bands, bandV, bandB and bandR.
However, our group interrupted data collection processing at second exposure, and changed
WCS setting. So I will only use the acceptable image data which start from third exposures
to the end. Here is the raw data image(opened in ds9 on HPC server) <a href="#fg1" style="color:blue;"><b>1</b></a>.
<img src="assets/images/raw.png" class = "imgcenter" id = "fg1">

							</p>
							<p>
							First, in the <i>calibrateM44</i> file, I prefer to calibrate the image because of CCD systematic
noise, there are three types in my case: bias, dark and flat. By using Eq. <a href="#eq1">(1)</a>, I can get a
set of calibrated datas. In python file, I need all the master files for bin = 1 to calibrate the
image. The loop is for all files from third exposures to the end and calibrate all images by
using the formula. Next, I need to do alignment about pixel-to-WCS conversion by creating
a bigger board(or canvas). In align file, by using find optimal celestial wcs command,
it finds an optimal size of canvas that will fit with every pixel and WCS coordinate images.
Then using a loop and reproject interp to loop over all calibrated image. This step will
map the pixels of image to the canvas. After that, use command sigma clip, which avoid
the effect of outliers [3] such as cosmic rays. Take the mean value of it, adjusting pixels to
zero if there were no good pixels to take a mean. Finally combine all adjusted parameters
such as exposure time and airmass into a new file. Next step I did(in sky subract file) was
subtracting the background bu using source extractor algorithm from python sep. The
parameter in sep.Background declares a box and a filter. It creates a smooth image
background. By subtracting the sky background data from image data and use deblending
algorithm sep.extract. I get a table of extracted data and a clear image of M44. See Fig. <a href="#fg2" style="color:blue;"><b>2</b></a>.
							
							</p>
							<img src="assets/images/sky.png" class = "imgcenter" id = "fg2">
							<p>
							For photometry analysis, I use <b>sep.kron_radius</b> from the photometry file to find the light-
weighted size with sky-subtracted image, the position of the star from the extracted table, semi-major,
semi-minor, and position angles of all objects. Then, by using <b>sep.sum</b> ellipse to sum data
in elliptical aperture. This step is used for extracting the light sources from each band
image. By using the equation
							</p>
							<p id="eq2">
							$$M = -2.5\log(\frac{counts}{t})$$
							</p>
							<p>
							where counts are the flux, t is the exposure time and M is the magnitude, to compute the
magnitude and magnitude error with standard error derivation of Eq. <a href="#eq2">(2)</a>. The function
<b>getMags</b> uses kron radius to calculate the magnitude and magnitude error. Also, I need
an extinction coefficient to correct the magnitude, this value may change for each night. In
my case, I use 0.54 for V-band, 0.76 for B-band, and 0.41 for R-band. Next, I match stars
in different catalogs by using the function <b>matchTables</b> based on right ascension and
declination coordinates. Finally, run over all bands to get values for the instrumental
magnitude of V-band and B-band. So I can create an H-R diagram. See Fig. <a href="#fg3" style="color:blue;"><b>3</b></a>.
							</p>
							<img src="assets/images/cmd_instrumental.png" class = "imgcenter" id = "fg3">
							<p>
							Compare the image with Stellarium M44 [<a href="#ct1" style="color:red;"><b>4</b></a>]. See Fig. <a href="#fg4" style="color:blue;"><b>4</b></a>
							
							. We can see that the far left bright
star is the 42 Cancri. The dim star is SAO 98023, which is a good selection for a reference
star to calculate apparent magnitude. The magnitudes data are: MagV = 9.45, MagB
= 9.79. See Fig. <a href="#fg5" style="color:blue;"><b>5</b></a>. 
The red circle star is the reference star, SAO 98023. The pixel location
from ds9 is x = 1088.15 and y = 2489.97. The center of the cluster is at x = 2087.24 and
y = 1890.91. Because the cluster is very huge, the image I took doesn’t cover all parts of
it. So all the stars in the image belong to the cluster, I choose the radius of the cluster to be 
half of the diagonal line of the square image, so it can cover all the stars. Then, by using
the coordinate of the reference star. I can use argmin to find the index of a minimum distance
for the reference star. So I can calculate the magnitude offset from the given value. The
offset between the actual B-band magnitude of the reference star and the B-band instrumental
magnitude is:
							</p>
							<img src="assets/images/Stellar.png" class = "imgcenter" id = "fg4">
							<img src="assets/images/SAO.png" class = "imgcenter" id = "fg5">
							
							<p>
							I select an isochrone with the lowest log Age of 6.0, the highest log Age of 10.0 with a 0.2 log
Age interval and metallicity of 0.019. I compute the b-v value for isochrone and get the
log age value from the isochrone table. To plot isochrone with M44, I only need a
single isochrone with some specific values for logAge, distance modulus, and E(B − V ). The
function <b>plotIsochrone</b> from fitCMD file declares that. It states a unique isochrone that
is closest to the given log-Age and chooses only the data point belonging to the closest isochrone.
Then it computes the new shape of the isochrone after the distance modulus and reddening are
applied. This function is for choosing an acceptable initial guess for fitting. I choose
logAge to be 8.75, distance modulus to be 7, and E(B − V ) to be 0.1. Compared to the H-R
diagram for M44, see Fig. <a href="#fg6" style="color:blue;"><b>6</b></a>.

We can see that the line passes through the main sequence well. So I can do the fitting
now. The function isochroneDistance from fitCMD file states the fitting function. It
creates a linear interpolation factor and uses it to interpolate between the minimum distances of
							</p>
							<img src="assets/images/fitByEye.png" class = "imgcenter" id = "fg6">
						</div>
						
						<p>
						We can see that the line passes through the main sequence well. So I can do the fitting
now. The function <b>isochroneDistance</b> from <i>fitCMD</i> file states the fitting function. It
creates a linear interpolation factor, uses it to interpolate between the minimum distances of
two isochrones, and uses these isochrones to find the theatrical values for apparent magnitude,
B-V. Then use sigma clipping to exclude the stars outside of the distance of 3σ from the
isochrones. The next function <b>fitfunction</b> from <i>fitCMD</i> file indicates the parameters used
in the function <b>isochroneDistance</b>. Plugin the <b>fitfunction</b> with the initial guess value. I got
a log Age value of 8.62, a distance modulus value of 6.82, and an E(B − V ) value of 0.16. See
Fig.  <a href="#fg7" style="color:blue;"><b>7</b></a>.
						</p>
						<img src="assets/images/numericalfit.png" class = "imgcenter" id = "fg7">
						<div>
						<h5 class="margin-top-30 margin-lg-top-40">Result</h5>
							<p>
							The optimized values for log Age, distance modulus, and reddening are 8.62, 6.82, and 0.16.
The log Age is 8.62 implies that the cluster age is around 417 million years. Compared
with the previous result of the estimated age of 500-700 million years, the value is a bit off. The
reasons for it, first, compare the H-R diagrams of my data and Fig. <a href="#fg8" style="color:blue;"><b>8</b></a> from Star Observer [<a href="#ct6" style="color:red;"><b>6</b></a>].
We can see that for my data, I don’t have the points for red giant, this will cause the
fitting curve to curve less right side at the top left part above the turning point. Second, the
value for metallicity I use is similar to the Sun(0.019), which may not be the same for M44.
According to Explaining the Praesepe blue straggler HD 73666 by L. Fossati, S. Mochnacki,
J. Landstreet and W. Weiss [<a href="#ct7" style="color:red;"><b>7</b></a>], the isochrone metallicity for M44 could be z = 0.024.
							</p>
							<img src="assets/images/Compare.jpg" class = "imgcenter" id = "fg8">
						</div>
						<div>
						<h5 class="margin-top-30 margin-lg-top-40">Conclusion</h5>
							<p>
							The estimation of the M44 cluster age is close to the previous experimental result, but without
the whole cluster stars, the value is lower than my expectation. However, the brightest stars
will saturate if the exposures are too long. The red giants are hard to be observed. For
reference star selection, I should use the dimmest star around turn off as a reference. This
would give a good apparent visual magnitude range of M44.							</p>
						</div>
						<div class="margin-top-30 margin-lg-top-40">
							<h5 class="fw-medium">References</h5>
							<ul class="list-dash">
							

								<li id="ct1">[1] McClure, B., Byrd, D. (2020) <i>The Beehive: 1000 stars in Cancer</i>. EarthSky.</li>
								
								<li id="ct2">[2] <i>Messier 44: Beehive Cluster</i>. Messier Objects. Retrieved from https://www.messier-
objects.com</li>
								<li id="ct3">[3] Akhlaghi, M. (2015). <i>GNU Astronomy Utilities</i>. Hong Kong: Samurai Media Limited.
Chap. 7.1.3.</li>
								<li id="ct4">[4] Stellarium Web Online Star Map. Retrieved from https://stellarium-web.org/</li>
								<li id="ct5">[5] SIMBAD query result. Retrieved from http://simbad.u-strasbg.fr/simbad/sim-id?Ident=
SAO 98023&submit=submit+id</li>
								<li id="ct6">[6] <i>M44praesepe</i>. Data from Star Observer.eu.</li>
								<li id="ct7">[7] L.Fossati., S.Mochnacki., J.Landstreet., W.Weiss. (2018) <i>Explaning the Praesepe blue straggler
HD 73666</i> ESO 2018. p.3.</li>
								<li>All codes are in python. With numpy, matplotlib. If you need the code please contact me by email.</li>
							</ul>
						</div>
					</div>
				</div><!-- end row -->
			</div><!-- end container -->
		</div>
		<!-- Job Listing Details -->

		<footer>
			<div class="section bg-dark">
				<div class="container">
					<div class="row g-4 align-items-center">
						<div class="col-12 col-md-6 text-center text-md-start">
							<ul class="list-inline-dash">
								<li><a href="#">FAQ</a></li>
								<li><a href="#">Careers</a></li>
							</ul>
							<p class="margin-top-10">&copy;Zehao Song, All Rights Reserved.</p>
						</div>
						<div class="col-12 col-md-6 text-center text-md-end">
							<ul class="list-inline">
								<li><a href="https://www.facebook.com/daniel.song.31/"><i class="bi bi-facebook"></i></a></li>
								<li><a href="https://www.linkedin.com/in/daniel-song-945008178/"><i class="bi bi-linkedin"></i></a></li>
								<li><a href="https://www.instagram.com/daniellsong/"><i class="bi bi-instagram"></i></a></li>
							</ul>
						</div>
					</div><!-- end row -->
				</div><!-- end container -->
			</div>
		</footer>

		<!-- Scroll to top button -->
		<div class="scrolltotop">
			<a class="button-circle button-circle-sm button-circle-dark" href="#"><i class="bi bi-arrow-up"></i></a>
		</div>
		<!-- end Scroll to top button -->

		<!-- ***** JAVASCRIPTS ***** -->
		<script src="assets/plugins/jquery.min.js"></script>
		<script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY"></script>
		<script src="https://polyfill.io/v3/polyfill.min.js?features=IntersectionObserver"></script>
		<script src="assets/plugins/plugins.js"></script>
		<script src="assets/js/functions.js"></script>
		<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
		<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>
	</body>
</html>